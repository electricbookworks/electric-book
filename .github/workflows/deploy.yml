name: Deploy to Electric Book Server

on:
  push: # Trigger on any push, but branch validation will filter
  workflow_dispatch: # Allow manual triggering

jobs:
  deploy:
    # Use the reusable workflow from the electric-book-deploy-workflow repository
    # Pin to a specific version for stability (replace 'main' with 'v1' when available)
    uses: electricbookworks/electric-book-deploy-workflow/.github/workflows/deploy.yml@v1.0.0
    with:
      config-file: '.github/workflows/deploy.config.json'
      node-version: '22'
      ruby-version: '3.1'
      checkout-fetch-depth: 0
    secrets: inherit  # This passes all secrets including GITHUB_TOKEN